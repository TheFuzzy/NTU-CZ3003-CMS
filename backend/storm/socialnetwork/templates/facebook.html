<!DOCTYPE html>

<html>
<head><title>Facebook Login</title>
{% load staticfiles %}
<script src="{% static 'Javascript/jquery-2.1.0.min.js' %}"></script>
<script>
jQuery.noConflict();
jQuery(document).ready(function() {
    jQuery("#fbPageForm").submit(function(event) {
        var pageId = jQuery("#fbPageForm").find("select[name=fbPage]").val();
        jQuery.post("{{ facebookProcessURI }}", { pageId: pageId })
            .done(function() {
                window.location.href = "{{ rootURI }}";
            })
            .fail(function() {
                console.error("Failed to submit page ID.");
                window.location.href = "{{ rootURI }}";
            });
        event.preventDefault();
    });
});
</script>
</head>
<body>
<!-- Begin Facebook SDK Embed -->
    <div id="fb-root"></div>
<!-- End Facebook SDK Embed -->
    <div>
        {% if pages %}
        <form id="fbPageForm">
            <label for="fbPageSelect">Page: </label>
            <select id="fbPageSelect" name="fbPage">
                {% for page in pages %}
                    <option value="{{ page.id }}">{{ page.name }}</option>
                {% endfor %}
            </select>
            <input type="submit" value="Submit" />
        </form>
        {% else %}
        <p>Please create a page for crisis updates, then try again.</p>
        {% endif %}
    </div>
</body>
</html>


